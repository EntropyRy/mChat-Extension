<!-- IF MCHAT_ARCHIVE_MODE or MCHAT_CUSTOM_PAGE -->
	<!-- INCLUDE overall_header.html -->
<!-- ENDIF -->

<!-- INCLUDEJS editor.js -->
<!-- INCLUDEJS jquery.titlealert.min.js -->
<!-- INCLUDEJS jquery_cookie_mini.js -->
<!-- IF MCHAT_MESSAGE_TOP -->
<!-- INCLUDEJS mchat_ajax_mini.js -->
<!-- ELSE -->
<!-- INCLUDEJS mchat_ajax_mini_top.js -->
<!-- ENDIF -->
<!-- INCLUDEJS jquery-1.8.3.min.js -->
<!-- INCLUDEJS jquery.maxlength.min.js -->
<!-- IF MCHAT_ARCHIVE_MODE -->
<!--**
*
* @package phpBB Extension - mChat
* @copyright (c) 2015 dmzx - http://www.dmzx-web.net
* @license http://opensource.org/licenses/gpl-2.0.php GNU General Public License v2
*
*/-->
<!-- IF .pagination or MCHAT_TOTAL_MESSAGES -->
<div class="action-bar top">
	<div class="pagination">
		{MCHAT_TOTAL_MESSAGES}
		<!-- IF .pagination -->
			<!-- INCLUDE pagination.html -->
		<!-- ELSE -->
			&bull; {PAGE_NUMBER}
		<!-- ENDIF -->
	</div>
	<!-- ENDIF -->
</div>
<!-- ENDIF -->
<!-- IF not MCHAT_READ_MODE -->
<div class="forabg">
	<div class="inner"><span class="corners-top"><span><a name="mChat"></a></span></span>
		<ul class="topiclist">
			<li class="header">
				<dl class="icon">
					<dt><!-- IF MCHAT_ARCHIVE_MODE -->{L_MCHAT_ARCHIVE_PAGE}<!-- ELSE -->{L_MCHAT_TITLE}<!-- ENDIF --></dt>
				</dl>
			</li>
		</ul>
		<div class="postbody mChatBodyFix">
<!-- ENDIF -->
	<!-- IF MCHAT_ENABLE -->
			<!-- IF not MCHAT_READ_MODE -->
            {% use 'form.html' %} 
			<script type="text/javascript">
			// <![CDATA[
			// Define mChat setting
			var mChatNoMessage = '{MCHAT_NOMESSAGE_MODE}';
			var mChatFile = '{MCHAT_FILE_NAME}';
			var mChatForumRoot = '{ROOT_PATH}';
			var mChatCustomPage = '{MCHAT_CUSTOM_PAGE}';
			<!-- IF not MCHAT_ARCHIVE_MODE -->
			var mChatPause = '{MCHAT_PAUSE_ON_INPUT}';
			var mChatRefresh = '{MCHAT_REFRESH_JS}';
			<!-- ELSE -->
			var mChatPause = false;
			var mChatRefresh = false;
			<!-- ENDIF -->
			<!-- IF MCHAT_USER_TIMEOUT -->
			var mChatUserTimeout = '{MCHAT_USER_TIMEOUT}';
			<!-- ELSE -->
			var mChatUserTimeout = false;
			<!-- ENDIF -->
			var mChatNewMessageAlert = '{LA_MCHAT_NEW_CHAT}';
			var mChatNoMessageInput = '{LA_MCHAT_NOMESSAGEINPUT}';
			var mChatNoMessage = '{LA_MCHAT_NOMESSAGE}';
            var mChatEditInfo = '{LA_MCHAT_EDITINFO}';
            var mChatTitleFlashDuration = '{S_MCHAT_TITLEFLASHDURATION}';
			var mChatNoAccess = '{LA_MCHAT_NOACCESS}';
			var mChatFlood = '{LA_MCHAT_FLOOD}';
			var mChatDelConfirm = '{LA_MCHAT_DELCONFIRM}';
			var mChatReset = '{LA_MCHAT_RESET_QUESTION}';
			var mChatRefreshing = '{LA_MCHAT_REFRESHING}';
			var mChatSessOut = '{LA_MCHAT_SESSION_OUT}';
			var mChatSessEnds = '{LA_MCHAT_SESSION_ENDS}';
			var mChatRefreshYes = '{MCHAT_REFRESH_YES}';
			var mChatRefreshNo = '{LA_MCHAT_REFRESH_NO}';
			var mChatMssgLngthLong = '{MCHAT_MESS_LONG}';
			var mChatLikes = '{LA_MCHAT_LIKES}';
			<!-- IF MCHAT_MESSAGE_LNGTH -->
			var mChatMssgLngth = '{MCHAT_MESSAGE_LNGTH}';
			<!-- ELSE -->
			var mChatMssgLngth = false;
			<!-- ENDIF -->
			<!-- IF S_MCHAT_SOUND_YES -->
			var mChatSound = true;
			<!-- ELSE -->
			var mChatSound = false;
			<!-- ENDIF -->
			<!-- IF MCHAT_WHOIS -->
			var mChatWhois = true;
			var mChatWhoisRefresh = '{MCHAT_WHOIS_REFRESH}';
			<!-- ELSE -->
			var mChatWhois = false;
			var mChatWhoisRefresh = false;
			<!-- ENDIF -->
			<!-- IF MCHAT_ARCHIVE_MODE -->
			var mChatArchiveMode = true;
			<!-- ELSE -->
			var mChatArchiveMode = false;
			var form_name = 'postform';
			var text_name = 'message';
			var mChatFocusFix = true;
			<!-- ENDIF -->
			function insert_quote(user,text)
			{
				var quote = decodeURIComponent(text.replace(/\+/g, " "));
				quote = quote.replace(/&lt;/g, "<");
				quote = quote.replace(/&gt;/g, ">");
				quote = quote.replace(/&#58;/g, ':');
				quote = quote.replace(/&#46;/g, '.');
				quote = quote.replace(/&amp;/g, '&');
				quote = quote.replace(/&quot;/g, '"');
				var username = decodeURIComponent(user.replace(/\+/g, " "));
				username = username.replace(/&lt;/g, "<");
				username = username.replace(/&gt;/g, ">");
				username = username.replace(/&#58;/g, ':');
				username = username.replace(/&#46;/g, '.');
				username = username.replace(/&amp;/g, '&');
				username = username.replace(/&quot;/g, '"');
				document.getElementById('mChatMessage').value += '[quote="' + username + '"]' + ' ' + quote + '[/quote]';
				document.getElementById('mChatMessage').focus();
			}

			function insert_like(user,text)
			{
				var quote = decodeURIComponent(text.replace(/\+/g, " "));
				quote = quote.replace(/&lt;/g, "<");
				quote = quote.replace(/&gt;/g, ">");
				quote = quote.replace(/&#58;/g, ':');
				quote = quote.replace(/&#46;/g, '.');
				quote = quote.replace(/&amp;/g, '&');
				quote = quote.replace(/&quot;/g, '"');
				var username = decodeURIComponent(user.replace(/\+/g, " "));
				username = username.replace(/&lt;/g, "<");
				username = username.replace(/&gt;/g, ">");
				username = username.replace(/&#58;/g, ':');
				username = username.replace(/&#46;/g, '.');
				username = username.replace(/&amp;/g, '&');
				username = username.replace(/&quot;/g, '"');
				document.getElementById('mChatMessage').value += '' + mChatLikes + '[quote="' + username + '"]' + ' ' + quote + '[/quote]';
				document.getElementById('mChatMessage').focus();
			}
			// ]]>
			</script>
			<!-- IF not MCHAT_ARCHIVE_MODE -->

            <div id="mChatmain" <!-- IF MCHAT_CUSTOM_PAGE -->class="mChatRowLimitCustom" style="height: {MCHAT_CUSTOM_HEIGHT}px;"<!-- ELSE -->class="mChatRowLimit" style="height: {MCHAT_INDEX_HEIGHT}px;"<!-- ENDIF -->>
                <!-- IF not MCHAT_MESSAGE_TOP and SCRIPT_NAME=='index' -->
            {{ block('form') }}
            <!-- ELSEIF not MCHAT_MESSAGE_TOP and SCRIPT_NAME!='index' -->
            <div style="text-align:center;">Message writing allowed only in index page</div>
            <!-- ENDIF -->
			<!-- ENDIF -->
			<div id="mChatData">
                <!-- ENDIF -->
			<!-- IF S_MCHAT_AVATARS == 1 -->
				<!-- INCLUDE mchat_avatars.html -->
			<!-- ELSEIF S_MCHAT_AVATARS == 0 -->
                <!-- INCLUDE mchat_no_avatars.html -->
            <!-- ELSEIF S_MCHAT_AVATARS == 2 -->
				<!-- INCLUDE mchat_simple_msg.html -->
			<!-- ENDIF -->
		    <!-- IF not MCHAT_READ_MODE -->
                <!-- IF MCHAT_NOMESSAGE_MODE --><div id="mChatNoMessage">{L_MCHAT_NOMESSAGE}</div><!-- ENDIF -->
			</div>
			<!-- IF not MCHAT_ARCHIVE_MODE -->
			</div>
			<!-- IF MCHAT_STATIC_MESS --><div class="mChatStatic"><strong>{L_MCHAT_ANNOUNCEMENT}{L_COLON}</strong> <span style="color:#990000;">{MCHAT_STATIC_MESS}</span></div><!-- ENDIF -->
            <!-- IF not (MCHAT_ARCHIVE_MODE or MCHAT_CUSTOM_PAGE) and MCHAT_WHOIS and S_MCHAT_INDEX_STATS --><div class="mChatStats" id="mChatStats"><!-- IF MCHAT_USERS_LIST --><a href="#" onclick="mChat.toggle('UserList'); return false;">{MCHAT_USERS_COUNT}</a><!-- ELSE -->{MCHAT_USERS_COUNT}<!-- ENDIF -->&nbsp;{L_MCHAT_ONLINE_EXPLAIN}<br /><span id="mChatUserList" >{MCHAT_USERS_LIST}</span></div><!-- ENDIF -->
            <!-- IF MCHAT_MESSAGE_TOP == 1 and SCRIPT_NAME=='index' -->
            {{ block('form') }}
            <!-- ELSEIF MCHAT_MESSAGE_TOP == 1 and SCRIPT_NAME!='index' -->
            <div style="text-align:center;">Message writing allowed only in index page</div>
            <!-- ENDIF -->
                    <div style="padding: 3px; text-align: center; clear:both;">
                        <img src="{ROOT_PATH}ext/dmzx/mchat/styles/prosilver/theme/images/load.gif" alt="{L_MCHAT_LOAD}" title="{L_MCHAT_LOAD}" id="mChatLoadIMG" class="mChatImageLoad" />
                        <img src="{ROOT_PATH}ext/dmzx/mchat/styles/prosilver/theme/images/ok.gif" alt="{L_MCHAT_OK}" title="{L_MCHAT_OK}" id="mChatOkIMG" class="mChatImageOk" />
                        <img src="{ROOT_PATH}ext/dmzx/mchat/styles/prosilver/theme/images/error.gif" alt="{L_MCHAT_ERROR}" title="{L_MCHAT_ERROR}" id="mChatErrorIMG" class="mChatImageHideImg" />
                        <img src="{ROOT_PATH}ext/dmzx/mchat/styles/prosilver/theme/images/paused.gif" alt="{L_MCHAT_PAUSE}" title="{L_MCHAT_PAUSE}" id="mChatPauseIMG" class="mChatImageHideImg" />
                        <span id="mChatRefreshText">{MCHAT_REFRESH_YES}</span><!-- IF MCHAT_USER_TIMEOUT --> &bull; <span id="mChatSessMess">&nbsp;</span><!-- ENDIF --> &bull; <label for="mChatUseSound">{L_MCHAT_USESOUND} <input type="checkbox" id="mChatUseSound" <!-- IF S_MCHAT_SOUND_YES -->checked="checked"<!-- ENDIF --> /></label>
                        {L_MCHAT_COPYRIGHT}
                    </div>
			<!-- ENDIF -->
			<div id="mChatSound" class="mChatSound"></div>

		<!-- ENDIF -->
	<!-- ELSE -->
	<div class="mchat_alert">{L_MCHAT_ENABLE}</div>
	<!-- ENDIF -->
	<!-- IF not MCHAT_READ_MODE -->
		</div>
	<span class="corners-bottom"><span></span></span></div>
</div>
	<!-- ENDIF -->
<!-- IF MCHAT_ARCHIVE_MODE -->
<div class="action-bar bottom">
<!-- IF .pagination or MCHAT_TOTAL_MESSAGES -->
	<div class="pagination">
		{MCHAT_TOTAL_MESSAGES}
		<!-- IF .pagination -->
			<!-- INCLUDE pagination.html -->
		<!-- ELSE -->
			&bull; {PAGE_NUMBER}
		<!-- ENDIF -->
	</div>
	<!-- ENDIF -->
</div>
<!-- ENDIF -->
<!-- IF MCHAT_CUSTOM_PAGE and MCHAT_WHOIS -->
<h3>{L_WHO_IS_CHATTING}</h3>
	<div class="mChatStats" id="mChatStats"><!-- IF MCHAT_USERS_LIST --><a href="#" onclick="mChat.toggle('UserList'); return false;">{MCHAT_USERS_COUNT}</a><!-- ELSE -->{MCHAT_USERS_COUNT}<!-- ENDIF -->&nbsp;{L_MCHAT_ONLINE_EXPLAIN}<br /><span id="mChatUserList">{MCHAT_USERS_LIST}</span></div>
	<div class="mChatRefresh"><span id="mChatRefresh">{L_MCHAT_WHOIS_REFRESH_EXPLAIN}</span><span id="mChatRefreshN" style="display: none;">{L_MCHAT_REFRESHING}</span>
<!-- IF LEGEND --><br /><em>{L_LEGEND}{L_COLON} {LEGEND}</em><!-- ENDIF --></div>
<!-- ENDIF -->
<!-- IF MCHAT_ARCHIVE_MODE or MCHAT_CUSTOM_PAGE -->
<!-- INCLUDE overall_footer.html -->
<!-- ENDIF -->

